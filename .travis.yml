sudo: false
language: node_js
node_js:
  - 11
env:
  global:
    - GITHUB_TOKEN: '${GITHUB_TOKEN}'

cache: 
  - npm
  directories:
  - node_modules
install:
  - npm install -g yarn
  - yarn

script:
  - yarn build
after_script:
  - cd ./build
  - git init
  - git config --global user.name "${U_NAME}"
  - git config --global user.email '${U_EMAIL}'
  - git add .
  - git commit -m "update tools"
  - git push --force --quiet "https://${GITHUB_TOKEN}@${GH_REF}" master:${P_BRANCH}

branches:
  only:
    - main